<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>إدارة السيارات | BARAH</title>
    <link rel="icon" href="logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>.admin-container{max-width:1000px;margin:40px auto;padding:20px;}.fleet-card{background:rgba(30,41,59,0.7);padding:20px;border-radius:15px;text-align:center;border:1px solid #334155;}.upload-area{border:2px dashed var(--gold);padding:30px;text-align:center;border-radius:15px;cursor:pointer;}</style>
</head>
<body>
    <div id="loginOverlay" style="position:fixed;inset:0;background:#0f172a;z-index:9999;display:flex;justify-content:center;align-items:center;"><div style="background:#1e293b;padding:40px;border-radius:15px;border:1px solid var(--gold);text-align:center;"><input type="password" id="passInput" placeholder="1234" style="text-align:center;margin-bottom:15px;"><button onclick="checkPass()" class="btn-primary" style="width:100%;">دخول</button></div></div>
    
    <div class="admin-container">
        <header style="display:flex;justify-content:space-between;margin-bottom:40px;"><h1 style="font-size:1.5rem;">إدارة السيارات</h1><a href="index.html" class="btn-secondary">للموقع</a></header>
        <div style="background:#1e293b;padding:30px;border-radius:20px;border:1px solid #334155;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px;"><select id="carBrand"><option value="mercedes">Mercedes</option><option value="bmw">BMW</option><option value="other">Other</option></select><input type="text" id="carName" placeholder="الاسم"></div>
            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;margin-bottom:15px;"><input type="number" id="carYear" placeholder="السنة"><input type="text" id="carColor" placeholder="اللون"><input type="number" id="carSeats" placeholder="الركاب"></div>
            <div class="upload-area" onclick="document.getElementById('carImage').click()"><p>رفع صورة</p><input type="file" id="carImage" hidden></div>
            <button onclick="addCar()" id="addBtn" class="btn-primary" style="width:100%;margin-top:20px;">حفظ</button>
        </div>
        <div id="fleetGrid" class="grid-system" style="margin-top:30px;"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        const app=initializeApp({apiKey:"AIzaSyDBRcr-Np9SwYRR-cBqJDZ7FZmwk6VWLJU",projectId:"barah-realestate-c7095"});
        const db=getFirestore(app);
        window.checkPass=()=>{if(document.getElementById('passInput').value==="1234"){document.getElementById('loginOverlay').style.display='none';loadCars();}else alert("خطأ");}
        async function uploadToImgBB(f){const d=new FormData();d.append("image",f);try{const r=await fetch(`https://api.imgbb.com/1/upload?key=f2f33c5aa9d3e304f8752aa2a80bd29b`,{method:"POST",body:d});const j=await r.json();return j.success?j.data.url:null;}catch{return null;}}
        window.addCar=async()=>{const btn=document.getElementById('addBtn');btn.innerText="جاري...";const url=await uploadToImgBB(document.getElementById('carImage').files[0]);if(url){await addDoc(collection(db,"vip_cars"),{brand:document.getElementById('carBrand').value,name:document.getElementById('carName').value,year:document.getElementById('carYear').value,color:document.getElementById('carColor').value,seats:document.getElementById('carSeats').value,image:url,createdAt:Date.now()});location.reload();}else{alert("فشل");btn.innerText="حفظ";}}
        async function loadCars(){const q=query(collection(db,"vip_cars"),orderBy("createdAt","desc"));const s=await getDocs(q);const g=document.getElementById('fleetGrid');g.innerHTML="";s.forEach(d=>{const c=d.data();g.innerHTML+=`<div class="fleet-card"><img src="${c.image}" style="width:100%;height:140px;object-fit:contain;"><h4>${c.name}</h4><button onclick="deleteDoc(doc(db,'vip_cars','${d.id}')).then(()=>location.reload())" style="background:#f00;color:#fff;border:0;padding:5px 10px;border-radius:5px;cursor:pointer;margin-top:10px;">حذف</button></div>`;});}
    </script>
</body>
</html>