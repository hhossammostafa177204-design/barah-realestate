<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BARAH SYSTEM | Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --gold-primary: #D4AF37; --bg-dark: #0f1215; --card-dark: #1a1d23; --text-main: #ffffff; }
        body { font-family: 'Tajawal'; background: var(--bg-dark); color: var(--text-main); margin: 0; padding: 20px; }
        .container { background: var(--card-dark); padding: 30px; border-radius: 15px; border: 1px solid #333; max-width: 800px; margin: 0 auto; }
        input, select, textarea { width: 100%; background: #222; border: 1px solid #444; color: #fff; padding: 12px; margin-bottom: 15px; border-radius: 8px; outline: none; box-sizing: border-box; font-family: 'Tajawal'; }
        .submit-btn { width: 100%; padding: 15px; background: var(--gold-primary); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1rem; }
        .login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    </style>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>

    <div id="loginOverlay" class="login-overlay">
        <h1 style="color:var(--gold-primary)">BARAH ADMIN</h1>
        <input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width: 250px; text-align: center;">
        <button class="submit-btn" style="width: 250px;" onclick="checkLogin()">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div class="container" id="dashboard" style="display:none;">
        <h2 style="color:var(--gold-primary); text-align:center;">Ø±ÙØ¹ ÙˆØ­Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
        
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø±Ø¶</label>
        <select id="type">
            <option value="sale">ØªÙ…Ù„ÙŠÙƒ</option>
            <option value="rent">Ø¥ÙŠØ¬Ø§Ø±</option>
        </select>

        <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±</label>
        <select id="unitType">
            <option value="Ø´Ù‚Ø©">Ø´Ù‚Ø©</option>
            <option value="ÙÙŠÙ„Ø§">ÙÙŠÙ„Ø§</option>
            <option value="Ø¯ÙˆØ¨Ù„ÙƒØ³">Ø¯ÙˆØ¨Ù„ÙƒØ³</option>
            <option value="Ù…ÙƒØªØ¨">Ù…ÙƒØªØ¨ Ø¥Ø¯Ø§Ø±ÙŠ</option>
            <option value="Ù…Ø­Ù„">Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ</option>
            <option value="Ø£Ø±Ø¶">Ø£Ø±Ø¶</option>
        </select>

        <input type="text" id="title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† (Ù…Ø«Ø§Ù„: Ø´Ù‚Ø© Ù„Ù„Ø¨ÙŠØ¹ ÙÙŠ Ø§Ù„Ø­ÙŠ Ø§Ù„ØªØ§Ø³Ø¹)">
        <input type="number" id="price" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø¬Ù†ÙŠØ©)">
        
        <select id="district">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø­ÙŠ / Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„ØªØ§Ø³Ø¹">Ø§Ù„Ø­ÙŠ Ø§Ù„ØªØ§Ø³Ø¹ (VIP)</option>
            <option value="Ø¬ÙˆÙ„Ù Ø³ÙŠØªÙŠ">Ø¬ÙˆÙ„Ù Ø³ÙŠØªÙŠ</option>
            <option value="Ø¬Ù…Ø¹ÙŠØ© Ø¹Ø±Ø§Ø¨ÙŠ">Ø¬Ù…Ø¹ÙŠØ© Ø¹Ø±Ø§Ø¨ÙŠ</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø£ÙˆÙ„</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø±Ø§Ø¨Ø¹">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø®Ø§Ù…Ø³</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø³Ø§Ø¯Ø³">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø³Ø§Ø¯Ø³</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø³Ø§Ø¨Ø¹">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø³Ø§Ø¨Ø¹</option>
            <option value="Ø§Ù„Ø­ÙŠ Ø§Ù„Ø«Ø§Ù…Ù†">Ø§Ù„Ø­ÙŠ Ø§Ù„Ø«Ø§Ù…Ù†</option>
            <option value="Ø§Ù„Ø¹Ø¨ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">Ø§Ù„Ø¹Ø¨ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</option>
            <option value="Ø¨ÙŠØª Ø§Ù„ÙˆØ·Ù†">Ø¨ÙŠØª Ø§Ù„ÙˆØ·Ù†</option>
        </select>

        <div style="display:flex; gap:10px;">
            <input type="number" id="rooms" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ØºØ±Ù">
            <input type="number" id="bathrooms" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù…Ø§Ù…Ø§Øª">
        </div>
        <div style="display:flex; gap:10px;">
            <input type="number" id="area" placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ù…ØªØ±)">
            <input type="number" id="floor" placeholder="Ø§Ù„Ø¯ÙˆØ±">
        </div>

        <textarea id="desc" rows="4" placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ø¹Ù‚Ø§Ø±..."></textarea>
        
        <div style="border: 2px dashed #444; padding: 20px; text-align: center; margin-bottom: 20px;">
            <p>ØµÙˆØ± Ø§Ù„Ø¹Ù‚Ø§Ø±</p>
            <input type="file" id="images" multiple accept="image/*">
        </div>

        <input type="text" id="phone" placeholder="Ø±Ù‚Ù… Ù„Ù„ØªÙˆØ§ØµÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) - Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø±Ù‚Ù… Ø§Ù„Ø´Ø±ÙƒØ©">

        <button class="submit-btn" onclick="upload()">Ù†Ø´Ø± Ø§Ù„ÙˆØ­Ø¯Ø©</button>
        <p id="status" style="text-align:center; margin-top:10px;"></p>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙØ§ÙŠØ±Ø¨ÙŠØ³
        const firebaseConfig = { apiKey: "AIzaSyDBRcr-Np9SwYRR-cBqJDZ7FZmwk6VWLJU", authDomain: "barah-realestate-c7095.firebaseapp.com", projectId: "barah-realestate-c7095", storageBucket: "barah-realestate-c7095.firebasestorage.app", messagingSenderId: "491079034147", appId: "1:491079034147:web:c7d985a6387dfa75a8d896" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¨Ø³ÙŠØ·
        function checkLogin() {
            if(document.getElementById('adminPass').value === 'AHE123') {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
            } else {
                alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø±ÙØ¹
        async function upload() {
            const status = document.getElementById('status');
            const files = document.getElementById('images').files;
            
            if(files.length === 0) { alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±"); return; }
            if(!document.getElementById('title').value) { alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø¹Ù†ÙˆØ§Ù†"); return; }

            status.innerText = "Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±...";
            status.style.color = "#D4AF37";

            // ğŸ”¥ Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ğŸ”¥
            const apiKey = "2b382d98a074d27c5304c08340d339ac";
            let imageUrls = [];

            try {
                // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± ØµÙˆØ±Ø© ØµÙˆØ±Ø©
                for(let i=0; i<files.length; i++) {
                    const formData = new FormData();
                    formData.append("image", files[i]);
                    
                    const response = await fetch(`https://api.imgbb.com/1/upload?key=${apiKey}`, {
                        method: "POST",
                        body: formData
                    });
                    
                    const data = await response.json();
                    if(data.success) {
                        imageUrls.push(data.data.url);
                    }
                }

                status.innerText = "Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";

                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ ÙØ§ÙŠØ±Ø¨ÙŠØ³
                await db.collection("apartments").add({
                    type: document.getElementById('type').value,
                    unitType: document.getElementById('unitType').value,
                    title: document.getElementById('title').value,
                    price: Number(document.getElementById('price').value),
                    district: document.getElementById('district').value,
                    rooms: document.getElementById('rooms').value,
                    bathrooms: document.getElementById('bathrooms').value,
                    area: document.getElementById('area').value,
                    floor: document.getElementById('floor').value,
                    description: document.getElementById('desc').value,
                    images: imageUrls, // Ù‡Ù†Ø§ Ø¨Ù†Ø­ÙØ¸ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ±
                    marketerPhone: document.getElementById('phone').value || "20110557821",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                status.innerText = "âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­!";
                status.style.color = "#25D366";
                setTimeout(() => location.reload(), 2000);

            } catch (error) {
                console.error(error);
                status.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£";
                status.style.color = "red";
            }
        }
    </script>
</body>
</html>